<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéì T·∫°o Th·∫ª Sinh Vi√™n - GitHub Pages</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .main-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 20px auto;
            padding: 30px;
        }
        .card-header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .student-item {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            transition: all 0.3s ease;
        }
        .student-item:hover {
            border-color: #667eea;
            background-color: #f8f9fa;
        }
        .student-item input[type="checkbox"] {
            transform: scale(1.2);
            margin-right: 10px;
        }
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-weight: 600;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .upload-area {
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #764ba2;
            background-color: #e9ecef;
        }
        .alert {
            border-radius: 10px;
            border: none;
        }
        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .card-preview {
            max-width: 200px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .canvas-container {
            display: none;
            margin: 20px 0;
        }
        .download-section {
            display: none;
            margin-top: 30px;
        }
        .generated-card {
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin: 10px;
            text-align: center;
            background: #f8f9fa;
        }
        .generated-card img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-container">
            <!-- Header -->
            <div class="card-header text-center">
                <h1><i class="fas fa-id-card me-2"></i>T·∫°o Th·∫ª Sinh Vi√™n Ver 2</h1>
                <p class="mb-0">
                    <i class="fas fa-robot me-1"></i>Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n<br>
                    <small class="text-light">
                        <i class="fas fa-check-circle me-1"></i>T·ª± ƒë·ªông tr√°nh tr√πng l·∫∑p |
                        <i class="fas fa-save me-1"></i>L∆∞u l·ªãch s·ª≠ t·∫°o th·∫ª |
                        <i class="fas fa-magic me-1"></i>Ch·ªâ c·∫ßn nh·∫≠p s·ªë l∆∞·ª£ng
                    </small>
                </p>
            </div>

            <!-- Alert Messages -->
            <div id="alertContainer"></div>

            <!-- Upload Template Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <h3><i class="fas fa-upload me-2"></i>Upload Template Th·∫ª</h3>
                    <div class="upload-area" onclick="document.getElementById('templateInput').click()">
                        <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                        <h5>K√©o th·∫£ file template v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</h5>
                        <p class="text-muted">H·ªó tr·ª£: PNG, JPG, JPEG</p>
                        <input type="file" id="templateInput" accept=".png,.jpg,.jpeg" style="display: none;">
                        <div id="templatePreview" class="mt-3"></div>
                    </div>
                    
                    <!-- C·∫•u h√¨nh v·ªã tr√≠ text -->
                    <div class="mt-3">
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="fas fa-cog me-2"></i>C·∫•u H√¨nh V·ªã Tr√≠ Text</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label class="form-label">T·ª∑ l·ªá ngang (X):</label>
                                        <input type="number" class="form-control" id="xPosition" value="0.50" step="0.01" min="0" max="1" onchange="updatePosition()">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">T·ª∑ l·ªá d·ªçc (Y):</label>
                                        <input type="number" class="form-control" id="yPosition" value="0.445" step="0.001" min="0" max="1" onchange="updatePosition()">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">K√≠ch th∆∞·ªõc font:</label>
                                        <input type="number" class="form-control" id="fontSize" value="30" onchange="updatePosition()">
                                    </div>
                                </div>
                                <small class="text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    S·ª≠ d·ª•ng t·ª∑ l·ªá (0-1) thay v√¨ t·ªça ƒë·ªô tuy·ªát ƒë·ªëi. V√≠ d·ª•: 0.56 = 56% t·ª´ tr√°i sang ph·∫£i
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Selection Section -->
            <div class="row">
                <div class="col-12">
                    <h3><i class="fas fa-magic me-2"></i>T·∫°o Th·∫ª T·ª± ƒê·ªông</h3>
                    
                    <!-- Auto Name Generation -->
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title"><i class="fas fa-robot me-2"></i>T·ª± ƒê·ªông T·∫°o T√™n Sinh Vi√™n</h6>
                            <label class="form-label"><i class="fas fa-hashtag me-2"></i>S·ªë l∆∞·ª£ng th·∫ª mu·ªën t·∫°o:</label>
                            <div class="input-group mb-3">
                                <input type="number" class="form-control" id="quantityInput" value="5" min="1" max="100" onchange="updateCount()">
                                <button class="btn btn-outline-secondary" type="button" onclick="document.getElementById('quantityInput').value = parseInt(document.getElementById('quantityInput').value) + 5; updateCount();">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button class="btn btn-outline-secondary" type="button" onclick="document.getElementById('quantityInput').value = Math.max(1, parseInt(document.getElementById('quantityInput').value) - 5); updateCount();">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                            <div class="alert alert-info">
                                <i class="fas fa-robot me-2"></i>
                                Script s·∫Ω t·ª± ƒë·ªông t·∫°o t√™n sinh vi√™n Vi·ªát Nam ng·∫´u nhi√™n, ƒë·∫£m b·∫£o kh√¥ng tr√πng v·ªõi c√°c t√™n ƒë√£ t·∫°o tr∆∞·ªõc ƒë√≥.
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <button type="button" class="btn btn-outline-warning btn-sm" onclick="resetUsedStudents()">
                                        <i class="fas fa-undo me-1"></i>Reset danh s√°ch t√™n ƒë√£ t·∫°o
                                    </button>
                                </div>
                                <span class="badge bg-primary" id="selectedCount">1 th·∫ª s·∫Ω ƒë∆∞·ª£c t·∫°o</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <button type="button" class="btn btn-primary btn-lg" id="createBtn" onclick="createCards()" disabled>
                            <i class="fas fa-magic me-2"></i>T·∫°o Th·∫ª Sinh Vi√™n
                        </button>
                    </div>
                </div>
            </div>

            <!-- Generated Cards Section -->
            <div class="download-section" id="downloadSection">
                <h3><i class="fas fa-download me-2"></i>Th·∫ª ƒê√£ T·∫°o</h3>
                <div id="generatedCards" class="row">
                    <!-- Generated cards will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden Canvas for Image Processing -->
    <canvas id="hiddenCanvas" style="display: none;"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Kh√¥ng c·∫ßn danh s√°ch sinh vi√™n v√¨ s·ª≠ d·ª•ng t√™n t·ª± ƒë·ªông
        const allStudents = [];

        // ============ CAU HINH VI TRI ============
        // S·ª≠ d·ª•ng t·ª∑ l·ªá thay v√¨ t·ªça ƒë·ªô tuy·ªát ƒë·ªëi
        const R_X = 0.55;       // left X ratio of the name area
        const R_Y = 0.475;     // top Y ratio of the name area (line with "H·ªç v√† t√™n:")
        const R_W = 0.52;       // width ratio of the name area
        const R_H = 0.055;      // height ratio of the name area
        const FONT_SIZE = 46;   // Kich thuoc font

        let templateImage = null;
        let usedStudents = new Set(); // L∆∞u tr·ªØ c√°c t√™n ƒë√£ ƒë∆∞·ª£c ch·ªçn

        // Kh·ªüi t·∫°o giao di·ªán
        function initializeApp() {
            loadUsedStudents();
            setupTemplateUpload();
            updateCount();
            updateStats();
        }

        // Load danh s√°ch sinh vi√™n ƒë√£ s·ª≠ d·ª•ng t·ª´ localStorage
        function loadUsedStudents() {
            const saved = localStorage.getItem('usedStudents');
            if (saved) {
                usedStudents = new Set(JSON.parse(saved));
            }
        }

        // L∆∞u danh s√°ch sinh vi√™n ƒë√£ s·ª≠ d·ª•ng v√†o localStorage
        function saveUsedStudents() {
            localStorage.setItem('usedStudents', JSON.stringify([...usedStudents]));
        }


        // Setup template upload
        function setupTemplateUpload() {
            const input = document.getElementById('templateInput');
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        templateImage = new Image();
                        templateImage.onload = function() {
                            showTemplatePreview();
                        };
                        templateImage.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // Hi·ªÉn th·ªã preview template
        function showTemplatePreview() {
            const preview = document.getElementById('templatePreview');
            preview.innerHTML = `
                <div class="text-center">
                    <img src="${templateImage.src}" class="card-preview" alt="Template Preview">
                    <p class="text-success mt-2"><i class="fas fa-check-circle me-1"></i>Template ƒë√£ ƒë∆∞·ª£c t·∫£i th√†nh c√¥ng!</p>
                    <div class="mt-2">
                        <button class="btn btn-outline-primary btn-sm" onclick="downloadTemplate()">
                            <i class="fas fa-download me-1"></i>T·∫£i Template
                        </button>
                    </div>
                </div>
            `;
        }

        // T·∫£i template hi·ªán t·∫°i
        function downloadTemplate() {
            if (templateImage) {
                const link = document.createElement('a');
                link.download = 'template.png';
                link.href = templateImage.src;
                link.click();
            }
        }

        // C·∫≠p nh·∫≠t v·ªã tr√≠ text
        function updatePosition() {
            const xRatio = document.getElementById('xPosition').value;
            const yRatio = document.getElementById('yPosition').value;
            const fontSize = document.getElementById('fontSize').value;
            
            // C·∫≠p nh·∫≠t c√°c h·∫±ng s·ªë
            window.R_X = parseFloat(xRatio);
            window.R_Y = parseFloat(yRatio);
            window.FONT_SIZE = parseInt(fontSize);
            
            showAlert(`ƒê√£ c·∫≠p nh·∫≠t v·ªã tr√≠: X=${xRatio}, Y=${yRatio}, Font=${fontSize}px`, 'info');
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng th·∫ª s·∫Ω ƒë∆∞·ª£c t·∫°o
        function updateCount() {
            const quantity = parseInt(document.getElementById('quantityInput').value) || 0;
            document.getElementById('selectedCount').textContent = quantity + ' th·∫ª s·∫Ω ƒë∆∞·ª£c t·∫°o';
            document.getElementById('createBtn').disabled = quantity === 0 || !templateImage;
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            const usedCount = usedStudents.size;
            const quantity = parseInt(document.getElementById('quantityInput').value) || 0;
            
            // C·∫≠p nh·∫≠t badge hi·ªÉn th·ªã s·ªë t√™n ƒë√£ t·∫°o
            const badge = document.getElementById('selectedCount');
            badge.textContent = `${quantity} th·∫ª s·∫Ω ƒë∆∞·ª£c t·∫°o | ƒê√£ t·∫°o: ${usedCount} t√™n`;
        }


        // Reset danh s√°ch sinh vi√™n ƒë√£ s·ª≠ d·ª•ng
        function resetUsedStudents() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën reset danh s√°ch t√™n ƒë√£ t·∫°o? T·∫•t c·∫£ t√™n s·∫Ω c√≥ th·ªÉ ƒë∆∞·ª£c t·∫°o l·∫°i.')) {
                usedStudents.clear();
                saveUsedStudents();
                updateStats();
                showAlert('ƒê√£ reset danh s√°ch t√™n ƒë√£ t·∫°o!', 'success');
            }
        }

        // T·∫°o t√™n sinh vi√™n ng·∫´u nhi√™n (gi·ªëng nh∆∞ app.py)
        function generateRandomName() {
            const familyNames = ["Nguy·ªÖn","Tr·∫ßn","L√™","Ph·∫°m","Ho√†ng","Hu·ª≥nh","Phan","V≈©","V√µ","ƒê·∫∑ng",
                "B√πi","ƒê·ªó","H·ªì","Ng√¥","D∆∞∆°ng","L√Ω","ƒêinh","Tr∆∞∆°ng","ƒêo√†n","Mai"];
            const middleNames = ["Th·ªã","VƒÉn","H·ªØu","Ng·ªçc","Minh","Quang","Gia","Anh","Thu·ª≥","Ph∆∞∆°ng",
                "Thanh","Tu·∫•n","H·∫£i","ƒê√¨nh","Ti·∫øn","B·∫£o","Xu√¢n","Kim","Di·ªáu","Trung"];
            const givenNames = ["An","Anh","B√°ch","B·∫£o","B√≠ch","B√¨nh","Ch√¢u","Chi","D≈©ng","Duy",
                "Giang","Hi·∫øu","Hi·ªÅn","Hoa","Ho√†","Ho√†i","H√πng","Huy","Huy·ªÅn","H∆∞∆°ng",
                "Kh√°nh","Khang","Khoa","Ki√™n","Lan","Linh","Loan","Long","Mai","Minh"];
            
            const family = familyNames[Math.floor(Math.random() * familyNames.length)];
            const middle = middleNames[Math.floor(Math.random() * middleNames.length)];
            const given = givenNames[Math.floor(Math.random() * givenNames.length)];
            
            return `${family} ${middle} ${given}`;
        }

        // T·∫°o th·∫ª sinh vi√™n
        function createCards() {
            if (!templateImage) {
                showAlert('Vui l√≤ng upload template tr∆∞·ªõc!', 'warning');
                return;
            }

            // T·∫°o t√™n ng·∫´u nhi√™n t·ª± ƒë·ªông
            const quantity = parseInt(document.getElementById('quantityInput').value) || 0;
            if (quantity === 0) {
                showAlert('Vui l√≤ng nh·∫≠p s·ªë l∆∞·ª£ng th·∫ª mu·ªën t·∫°o!', 'warning');
                return;
            }
            
            // T·∫°o t√™n ng·∫´u nhi√™n kh√¥ng tr√πng
            const selectedStudents = [];
            const attempts = quantity * 10;
            
            for (let i = 0; i < attempts && selectedStudents.length < quantity; i++) {
                const name = generateRandomName();
                if (!usedStudents.has(name) && !selectedStudents.includes(name)) {
                    selectedStudents.push(name);
                }
            }
            
            if (selectedStudents.length < quantity) {
                showAlert(`Ch·ªâ c√≥ th·ªÉ t·∫°o ${selectedStudents.length}/${quantity} t√™n kh√¥ng tr√πng. Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c gi·∫£m s·ªë l∆∞·ª£ng.`, 'warning');
            }

            showAlert(`ƒêang t·∫°o ${selectedStudents.length} th·∫ª...`, 'info');
            
            // T·∫°o th·∫ª cho t·ª´ng sinh vi√™n
            const generatedCards = [];
            selectedStudents.forEach(studentName => {
                const cardData = createStudentCard(studentName);
                if (cardData) {
                    generatedCards.push({
                        name: studentName,
                        dataUrl: cardData
                    });
                    
                    // ƒê√°nh d·∫•u sinh vi√™n ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng
                    usedStudents.add(studentName);
                }
            });

            if (generatedCards.length > 0) {
                // L∆∞u danh s√°ch sinh vi√™n ƒë√£ s·ª≠ d·ª•ng
                saveUsedStudents();
                
                // C·∫≠p nh·∫≠t giao di·ªán
                updateStats();
                
                showGeneratedCards(generatedCards);
                showAlert(`ƒê√£ t·∫°o th√†nh c√¥ng ${generatedCards.length} th·∫ª sinh vi√™n!`, 'success');
            } else {
                showAlert('Kh√¥ng th·ªÉ t·∫°o th·∫ª. Vui l√≤ng ki·ªÉm tra template.', 'danger');
            }
        }

        // T·∫°o th·∫ª cho m·ªôt sinh vi√™n
        function createStudentCard(studentName) {
            try {
                const canvas = document.getElementById('hiddenCanvas');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size to match template
                canvas.width = templateImage.width;
                canvas.height = templateImage.height;
                
                // Draw template
                ctx.drawImage(templateImage, 0, 0);
                
                // Add text
                const currentFontSize = window.FONT_SIZE || FONT_SIZE;
                ctx.font = `${currentFontSize}px Arial`;
                ctx.fillStyle = '#000000';
                ctx.textAlign = 'left';
                ctx.textBaseline = 'top';
                
                // Position text using ratios (like in app.py)
                const currentR_X = window.R_X || R_X;
                const currentR_Y = window.R_Y || R_Y;
                const x = canvas.width * currentR_X;
                const y = canvas.height * currentR_Y;
                
                ctx.fillText(studentName, x, y);
                
                return canvas.toDataURL('image/png');
            } catch (error) {
                console.error('Error creating card:', error);
                return null;
            }
        }

        // Hi·ªÉn th·ªã th·∫ª ƒë√£ t·∫°o
        function showGeneratedCards(cards) {
            const container = document.getElementById('generatedCards');
            const section = document.getElementById('downloadSection');
            
            container.innerHTML = cards.map(card => `
                <div class="col-md-4 col-sm-6 mb-3">
                    <div class="generated-card">
                        <img src="${card.dataUrl}" alt="${card.name}" class="mb-2">
                        <h6>${card.name}</h6>
                        <div class="btn-group" role="group">
                            <button class="btn btn-outline-primary btn-sm" onclick="downloadCard('${card.dataUrl}', '${card.name}')">
                                <i class="fas fa-download me-1"></i>Download
                            </button>
                            <button class="btn btn-outline-success btn-sm" onclick="generateFormScript('${card.name}')">
                                <i class="fas fa-code me-1"></i>Script Form
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            section.style.display = 'block';
        }

        // Download th·∫ª
        function downloadCard(dataUrl, name) {
            const link = document.createElement('a');
            link.download = `card_${name.replace(/\s+/g, '_')}.png`;
            link.href = dataUrl;
            link.click();
        }

        // T·∫°o script form t·ª± ƒë·ªông ƒëi·ªÅn
        function generateFormScript(studentName) {
            // T√°ch h·ªç v√† t√™n
            const nameParts = studentName.trim().split(' ');
            const lastName = nameParts[nameParts.length - 1];
            const firstName = nameParts.slice(0, -1).join(' ');
            
            // T·∫°o email (b·ªè d·∫•u, kh√¥ng c√≥ d·∫•u ch·∫•m)
            const email = `${studentName.toLowerCase()
                .replace(/[√†√°·∫°·∫£√£√¢·∫ß·∫•·∫≠·∫©·∫´ƒÉ·∫±·∫Ø·∫∑·∫≥·∫µ]/g, 'a')
                .replace(/[√®√©·∫π·∫ª·∫Ω√™·ªÅ·∫ø·ªá·ªÉ·ªÖ]/g, 'e')
                .replace(/[√¨√≠·ªã·ªâƒ©]/g, 'i')
                .replace(/[√≤√≥·ªç·ªè√µ√¥·ªì·ªë·ªô·ªï·ªó∆°·ªù·ªõ·ª£·ªü·ª°]/g, 'o')
                .replace(/[√π√∫·ª•·ªß≈©∆∞·ª´·ª©·ª±·ª≠·ªØ]/g, 'u')
                .replace(/[·ª≥√Ω·ªµ·ª∑·ªπ]/g, 'y')
                .replace(/ƒë/g, 'd')
                .replace(/\s+/g, '')
                .replace(/[^a-z0-9]/g, '')}@ttn.edu.vn`;
            
            // T·∫°o script
            const script = `// Script t·ª± ƒë·ªông ƒëi·ªÅn form cho ${studentName}
(async () => {
    const delay = ms => new Promise(r => setTimeout(r, ms));
    const set = async (sel, val) => {
        const el = document.querySelector(sel);
        if (!el) return;
        const setVal = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, "value").set;
        setVal.call(el, val);
        el.dispatchEvent(new Event("input", { bubbles: true }));
        el.dispatchEvent(new Event("change", { bubbles: true }));
        el.dispatchEvent(new Event("blur", { bubbles: true }));
        await delay(150);
    };
    
    const pasteSchool = async (schoolName) => {
        console.log("üè´ B·∫Øt ƒë·∫ßu ch·ªçn tr∆∞·ªùng ƒë·∫°i h·ªçc...");
        
        // T√¨m tr∆∞·ªùng ƒë·∫°i h·ªçc v·ªõi nhi·ªÅu selector kh√°c nhau
        const schoolSelectors = [
            'input[placeholder*="T√™n ƒê·∫°i h·ªçc"]',
            'input[placeholder*="University"]',
            'input[placeholder*="College"]',
            'input[name*="university"]',
            'input[name*="school"]',
            '#university',
            '#school',
            '.university-select',
            '.school-select',
            '[data-testid*="university"]',
            '[data-testid*="school"]'
        ];
        
        let schoolEl = null;
        for (const selector of schoolSelectors) {
            schoolEl = document.querySelector(selector);
            if (schoolEl) {
                console.log(\`‚úÖ T√¨m th·∫•y tr∆∞·ªùng ƒë·∫°i h·ªçc v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        if (!schoolEl) {
            console.log("‚ùå Kh√¥ng t√¨m th·∫•y tr∆∞·ªùng ƒë·∫°i h·ªçc");
            return;
        }
        
        console.log("üîç Tr∆∞·ªùng ƒë·∫°i h·ªçc:", schoolEl);
        
        // Click v√†o dropdown ƒë·ªÉ m·ªü danh s√°ch
        schoolEl.focus();
        schoolEl.click();
        console.log("üñ±Ô∏è ƒê√£ click v√†o dropdown tr∆∞·ªùng ƒë·∫°i h·ªçc");
        await delay(2000);
        
        // T√¨m dropdown container
        const dropdownSelectors = [
            '[role="listbox"]',
            '.dropdown-menu',
            '.select-dropdown',
            '.ant-select-dropdown',
            '.rc-select-dropdown',
            '.el-select-dropdown',
            '[class*="dropdown"]',
            '[class*="menu"]',
            '[class*="select"]'
        ];
        
        let dropdownContainer = null;
        for (const selector of dropdownSelectors) {
            dropdownContainer = document.querySelector(selector);
            if (dropdownContainer) {
                console.log(\`‚úÖ T√¨m th·∫•y dropdown container v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        if (!dropdownContainer) {
            console.log("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y dropdown container, th·ª≠ t√¨m options tr·ª±c ti·∫øp");
        }
        
        // T√¨m t·∫•t c·∫£ options trong dropdown
        const optionSelectors = [
            '[role="option"]',
            '.option',
            'li[data-value]',
            'div[data-value]',
            '.dropdown-item',
            '.select-option',
            '.menu-item',
            '.list-item',
            'li',
            'div[class*="option"]',
            'div[class*="item"]'
        ];
        
        let options = [];
        for (const selector of optionSelectors) {
            options = [...document.querySelectorAll(selector)];
            if (options.length > 0) {
                console.log(\`‚úÖ T√¨m th·∫•y \${options.length} options v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // Debug: Hi·ªÉn th·ªã t·∫•t c·∫£ options
        console.log("üîç T·∫•t c·∫£ options c√≥ s·∫µn:");
        options.forEach((option, index) => {
            const text = option.innerText || option.textContent || '';
            console.log(\`  \${index + 1}. "\${text}"\`);
        });
        
        // T√¨m option Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n v·ªõi nhi·ªÅu t√™n kh√°c nhau
        let targetOption = options.find(o => {
            const text = o.innerText || o.textContent || '';
            const lowerText = text.toLowerCase();
            return lowerText.includes('tr∆∞·ªùng ƒë·∫°i h·ªçc s√†i g√≤n') ||
                   lowerText.includes('sai gon university') ||
                   lowerText.includes('sgu') ||
                   lowerText.includes('ƒë·∫°i h·ªçc s√†i g√≤n') ||
                   lowerText.includes('university of saigon') ||
                   lowerText.includes('saigon university') ||
                   lowerText.includes('tr∆∞·ªùng ƒë·∫°i h·ªçc s√†i g√≤n (district 5)') ||
                   lowerText.includes('sai gon university (district 5)') ||
                   lowerText.includes('ƒë·∫°i h·ªçc s√†i g√≤n (district 5)');
        });
        
        if (targetOption) {
            const selectedText = targetOption.innerText || targetOption.textContent || '';
            console.log(\`‚úÖ T√¨m th·∫•y option: "\${selectedText}"\`);
            
            // Scroll v√†o view v√† click
            targetOption.scrollIntoView({ behavior: 'smooth', block: 'center' });
            await delay(500);
            targetOption.click();
            console.log(\`‚úÖ ƒê√£ click v√†o: "\${selectedText}"\`);
            
        } else {
            console.log("‚ùå Kh√¥ng t√¨m th·∫•y Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n trong options, th·ª≠ cu·ªôn v√† t√¨m...");
            
            // Cu·ªôn trong dropdown ƒë·ªÉ t√¨m tr∆∞·ªùng
            if (dropdownContainer) {
                console.log("üîÑ Cu·ªôn trong dropdown container...");
                
                // Cu·ªôn xu·ªëng ƒë·ªÉ t√¨m tr∆∞·ªùng
                for (let i = 0; i < 20; i++) {
                    dropdownContainer.scrollTop += 100;
                    await delay(300);
                    
                    // T√¨m l·∫°i options sau khi cu·ªôn
                    const newOptions = [...document.querySelectorAll('[role="option"], .option, li, div[class*="option"]')];
                    
                    targetOption = newOptions.find(o => {
                        const text = o.innerText || o.textContent || '';
                        const lowerText = text.toLowerCase();
                        return lowerText.includes('tr∆∞·ªùng ƒë·∫°i h·ªçc s√†i g√≤n') ||
                               lowerText.includes('sai gon university') ||
                               lowerText.includes('sgu') ||
                               lowerText.includes('ƒë·∫°i h·ªçc s√†i g√≤n') ||
                               lowerText.includes('university of saigon');
                    });
                    
                    if (targetOption) {
                        const selectedText = targetOption.innerText || targetOption.textContent || '';
                        console.log(\`‚úÖ T√¨m th·∫•y sau khi cu·ªôn: "\${selectedText}"\`);
                        targetOption.click();
                        console.log(\`‚úÖ ƒê√£ click v√†o: "\${selectedText}"\`);
                        break;
                    }
                }
            }
            
            // N·∫øu v·∫´n kh√¥ng t√¨m th·∫•y, th·ª≠ t√¨m t·∫•t c·∫£ elements
            if (!targetOption) {
                console.log("üîç T√¨m t·∫•t c·∫£ elements c√≥ ch·ª©a Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n...");
                const allElements = document.querySelectorAll('*');
                const schoolElements = Array.from(allElements).filter(el => {
                    const text = el.innerText || el.textContent || '';
                    return text.toLowerCase().includes('tr∆∞·ªùng ƒë·∫°i h·ªçc s√†i g√≤n') ||
                           text.toLowerCase().includes('sai gon university') ||
                           text.toLowerCase().includes('sgu') ||
                           text.toLowerCase().includes('ƒë·∫°i h·ªçc s√†i g√≤n') ||
                           text.toLowerCase().includes('saigon university');
                });
                
                console.log(\`üîç T√¨m th·∫•y \${schoolElements.length} elements c√≥ ch·ª©a SGU:\`);
                schoolElements.forEach((el, i) => {
                    console.log(\`  \${i + 1}. \${el.tagName}: "\${el.innerText || el.textContent}"\`);
                });
                
                if (schoolElements.length > 0) {
                    console.log("üñ±Ô∏è Click v√†o element ƒë·∫ßu ti√™n...");
                    schoolElements[0].click();
                } else {
                    console.log("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n, th·ª≠ nh·∫≠p th·ªß c√¥ng...");
                    
                    // Th·ª≠ nh·∫≠p th·ªß c√¥ng v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc
                    const schoolInput = document.querySelector('input[placeholder*="T√™n ƒê·∫°i h·ªçc"], input[placeholder*="University"], input[placeholder*="College"]');
                    if (schoolInput) {
                        console.log("üìù Nh·∫≠p th·ªß c√¥ng t√™n tr∆∞·ªùng...");
                        schoolInput.focus();
                        schoolInput.value = '';
                        schoolInput.value = 'Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n';
                        schoolInput.dispatchEvent(new Event('input', { bubbles: true }));
                        schoolInput.dispatchEvent(new Event('change', { bubbles: true }));
                        await delay(1000);
                        
                        // Ki·ªÉm tra xem c√≥ b·ªã ƒëi·ªÅn nh·∫ßm t√™n sinh vi√™n kh√¥ng
                        if (schoolInput.value.includes('${studentName}') || schoolInput.value.includes('${firstName}') || schoolInput.value.includes('${lastName}')) {
                            console.log("‚ö†Ô∏è Ph√°t hi·ªán t√™n sinh vi√™n b·ªã ƒëi·ªÅn nh·∫ßm v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc!");
                            console.log("üîÑ X√≥a v√† ƒëi·ªÅn l·∫°i t√™n tr∆∞·ªùng...");
                            schoolInput.value = '';
                            schoolInput.value = 'Tr∆∞·ªùng ƒê·∫°i h·ªçc S√†i G√≤n';
                            schoolInput.dispatchEvent(new Event('input', { bubbles: true }));
                            schoolInput.dispatchEvent(new Event('change', { bubbles: true }));
                            await delay(1000);
                        }
                    }
                }
            }
        }
        
        await delay(1000);
        console.log("üìù Gi√° tr·ªã cu·ªëi c√πng:", schoolEl.value);
        console.log("‚úÖ Ho√†n th√†nh ch·ªçn tr∆∞·ªùng ƒë·∫°i h·ªçc");
    };
    
    const selectCountry = async (countryName) => {
        console.log("üöÄ B·∫Øt ƒë·∫ßu ch·ªçn qu·ªëc gia...");
        
        // T√¨m tr∆∞·ªùng qu·ªëc gia v·ªõi nhi·ªÅu selector kh√°c nhau
        const countrySelectors = [
            'input[placeholder*="Qu·ªëc gia"]',
            'input[placeholder*="Country"]', 
            'select[name*="country"]',
            'input[name*="country"]',
            '#country',
            '.country-select',
            '[data-testid*="country"]'
        ];
        
        let countryEl = null;
        for (const selector of countrySelectors) {
            countryEl = document.querySelector(selector);
            if (countryEl) {
                console.log(\`‚úÖ T√¨m th·∫•y tr∆∞·ªùng qu·ªëc gia v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        if (!countryEl) {
            console.log("‚ùå Kh√¥ng t√¨m th·∫•y tr∆∞·ªùng Qu·ªëc gia");
            return;
        }
        
        console.log("üîç Tr∆∞·ªùng qu·ªëc gia:", countryEl);
        console.log("üìù Gi√° tr·ªã hi·ªán t·∫°i:", countryEl.value);
        
        // Click v√†o dropdown ƒë·ªÉ m·ªü danh s√°ch
        countryEl.focus();
        countryEl.click();
        console.log("üñ±Ô∏è ƒê√£ click v√†o dropdown qu·ªëc gia");
        await delay(2000);
        
        // T√¨m dropdown container
        const dropdownSelectors = [
            '[role="listbox"]',
            '.dropdown-menu',
            '.select-dropdown',
            '.ant-select-dropdown',
            '.rc-select-dropdown',
            '.el-select-dropdown',
            '[class*="dropdown"]',
            '[class*="menu"]',
            '[class*="select"]'
        ];
        
        let dropdownContainer = null;
        for (const selector of dropdownSelectors) {
            dropdownContainer = document.querySelector(selector);
            if (dropdownContainer) {
                console.log(\`‚úÖ T√¨m th·∫•y dropdown container v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        if (!dropdownContainer) {
            console.log("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y dropdown container, th·ª≠ t√¨m options tr·ª±c ti·∫øp");
        }
        
        // T√¨m t·∫•t c·∫£ options trong dropdown
        const optionSelectors = [
            '[role="option"]',
            '.option',
            'li[data-value]',
            'div[data-value]',
            '.dropdown-item',
            '.select-option',
            '.menu-item',
            '.list-item',
            'li',
            'div[class*="option"]',
            'div[class*="item"]'
        ];
        
        let options = [];
        for (const selector of optionSelectors) {
            options = [...document.querySelectorAll(selector)];
            if (options.length > 0) {
                console.log(\`‚úÖ T√¨m th·∫•y \${options.length} options v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // Debug: Hi·ªÉn th·ªã t·∫•t c·∫£ options
        console.log("üîç T·∫•t c·∫£ options c√≥ s·∫µn:");
        options.forEach((option, index) => {
            const text = option.innerText || option.textContent || '';
            console.log(\`  \${index + 1}. "\${text}"\`);
        });
        
        // T√¨m option Vi·ªát Nam
        let targetOption = options.find(o => {
            const text = o.innerText || o.textContent || '';
            const lowerText = text.toLowerCase();
            return lowerText === 'vi·ªát nam' ||
                   lowerText.includes('vi·ªát nam') ||
                   lowerText.includes('vietnam') ||
                   lowerText.includes('viet nam');
        });
        
        if (targetOption) {
            const selectedText = targetOption.innerText || targetOption.textContent || '';
            console.log(\`‚úÖ T√¨m th·∫•y option: "\${selectedText}"\`);
            
            // Scroll v√†o view v√† click
            targetOption.scrollIntoView({ behavior: 'smooth', block: 'center' });
            await delay(500);
            targetOption.click();
            console.log(\`‚úÖ ƒê√£ click v√†o: "\${selectedText}"\`);
            
        } else {
            console.log("‚ùå Kh√¥ng t√¨m th·∫•y Vi·ªát Nam trong options, th·ª≠ cu·ªôn v√† t√¨m...");
            
            // Cu·ªôn trong dropdown ƒë·ªÉ t√¨m Vi·ªát Nam
            if (dropdownContainer) {
                console.log("üîÑ Cu·ªôn trong dropdown container...");
                
                // Cu·ªôn xu·ªëng ƒë·ªÉ t√¨m Vi·ªát Nam
                for (let i = 0; i < 10; i++) {
                    dropdownContainer.scrollTop += 100;
                    await delay(300);
                    
                    // T√¨m l·∫°i options sau khi cu·ªôn
                    const newOptions = [...document.querySelectorAll('[role="option"], .option, li, div[class*="option"]')];
                    
                    targetOption = newOptions.find(o => {
                        const text = o.innerText || o.textContent || '';
                        const lowerText = text.toLowerCase();
                        return lowerText.includes('vi·ªát nam') ||
                               lowerText.includes('vietnam') ||
                               lowerText.includes('viet nam');
                    });
                    
                    if (targetOption) {
                        const selectedText = targetOption.innerText || targetOption.textContent || '';
                        console.log(\`‚úÖ T√¨m th·∫•y sau khi cu·ªôn: "\${selectedText}"\`);
                        targetOption.click();
                        console.log(\`‚úÖ ƒê√£ click v√†o: "\${selectedText}"\`);
                        break;
                    }
                }
            }
        }
        
        await delay(1000);
        console.log("üìù Gi√° tr·ªã cu·ªëi c√πng:", countryEl.value);
        console.log("‚úÖ Ho√†n th√†nh ch·ªçn qu·ªëc gia");
    };
    
    const selectMonth = async () => {
        const el = document.querySelector('#sid-birthdate__month');
        if (!el) return;
        el.focus();
        el.click();
        await delay(500);
        
        // T√¨m v√† ch·ªçn th√°ng 8 v·ªõi nhi·ªÅu t√πy ch·ªçn
        const monthOptions = [...document.querySelectorAll('#sid-birthdate__month-menu [role="option"]')];
        const augustOption = monthOptions.find(o => 
            o.innerText.includes("Th√°ng 8") || 
            o.innerText.toLowerCase().includes("th√°ng 8") || 
            o.innerText.toLowerCase().includes("th√°ng t√°m") || 
            o.innerText.toLowerCase().includes("august") ||
            o.innerText.toLowerCase().startsWith("aug") ||
            o.innerText.includes("8") ||
            o.innerText.includes("08")
        );
        
        if (augustOption) {
            augustOption.click();
            console.log("‚úÖ ƒê√£ ch·ªçn Th√°ng 8");
        } else {
            console.log("‚ùå Kh√¥ng t√¨m th·∫•y Th√°ng 8 trong dropdown");
        }
        await delay(300);
    };
    
    await selectCountry("Vi·ªát Nam");
    await delay(2000); // ƒê·ª£i dropdown qu·ªëc gia load xong
    // B·ªè qua ch·ªçn tr∆∞·ªùng ƒë·∫°i h·ªçc
    console.log("‚è≠Ô∏è B·ªè qua ch·ªçn tr∆∞·ªùng ƒë·∫°i h·ªçc theo y√™u c·∫ßu");
    await selectMonth();
    
    // ƒêi·ªÅn th√¥ng tin c√° nh√¢n v·ªõi nhi·ªÅu selector kh√°c nhau
    const fillPersonalInfo = async () => {
        console.log("üë§ B·∫Øt ƒë·∫ßu ƒëi·ªÅn th√¥ng tin c√° nh√¢n...");
        
        // T√™n - Tr√°nh ƒëi·ªÅn nh·∫ßm v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc
        const firstNameSelectors = [
            'input[placeholder*="T√™n"]:not([placeholder*="ƒê·∫°i h·ªçc"]):not([placeholder*="University"]):not([placeholder*="College"])',
            'input[name*="first"]:not([name*="university"]):not([name*="school"])',
            'input[name*="given"]:not([name*="university"]):not([name*="school"])',
            '#first-name:not([id*="university"]):not([id*="school"])',
            '#given-name:not([id*="university"]):not([id*="school"])'
        ];
        
        for (const selector of firstNameSelectors) {
            const el = document.querySelector(selector);
            if (el && !el.value && !el.placeholder?.includes('ƒê·∫°i h·ªçc') && !el.placeholder?.includes('University') && !el.placeholder?.includes('College')) {
                await set(selector, '${firstName}');
                console.log(\`‚úÖ ƒê√£ ƒëi·ªÅn t√™n v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // H·ªç
        const lastNameSelectors = [
            'input[placeholder*="H·ªç"]',
            'input[name*="last"]',
            'input[name*="family"]',
            '#last-name',
            '#family-name',
            'input[type="text"]:nth-of-type(2)'
        ];
        
        for (const selector of lastNameSelectors) {
            const el = document.querySelector(selector);
            if (el && !el.value) {
                await set(selector, '${lastName}');
                console.log(\`‚úÖ ƒê√£ ƒëi·ªÅn h·ªç v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // Ng√†y sinh
        const daySelectors = [
            'input[placeholder*="N..."]',
            'input[placeholder*="Ng√†y"]',
            'input[name*="day"]',
            '#day',
            'input[type="number"]:nth-of-type(1)'
        ];
        
        for (const selector of daySelectors) {
            const el = document.querySelector(selector);
            if (el && !el.value) {
                await set(selector, '18');
                console.log(\`‚úÖ ƒê√£ ƒëi·ªÅn ng√†y v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // NƒÉm sinh
        const yearSelectors = [
            'input[placeholder*="NƒÉm"]',
            'input[name*="year"]',
            '#year',
            'input[type="number"]:nth-of-type(2)'
        ];
        
        for (const selector of yearSelectors) {
            const el = document.querySelector(selector);
            if (el && !el.value) {
                await set(selector, '1997');
                console.log(\`‚úÖ ƒê√£ ƒëi·ªÅn nƒÉm v·ªõi selector: \${selector}\`);
                break;
            }
        }
        
        // Email
        const emailSelectors = [
            'input[placeholder*="email"]',
            'input[type="email"]',
            'input[name*="email"]',
            '#email',
            'input[placeholder*="ƒê·ªãa ch·ªâ email"]'
        ];
        
        for (const selector of emailSelectors) {
            const el = document.querySelector(selector);
            if (el && !el.value) {
                await set(selector, '${email}');
                console.log(\`‚úÖ ƒê√£ ƒëi·ªÅn email v·ªõi selector: \${selector}\`);
                break;
            }
        }
    };
    
    // ƒêi·ªÅn th√¥ng tin c√° nh√¢n
    await fillPersonalInfo();
    
    // Ki·ªÉm tra v√† s·ª≠a l·ªói ƒëi·ªÅn nh·∫ßm t√™n sinh vi√™n v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc
    await delay(1000);
    console.log("üîç Ki·ªÉm tra xem c√≥ b·ªã ƒëi·ªÅn nh·∫ßm t√™n sinh vi√™n v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc kh√¥ng...");
    
    const schoolInput = document.querySelector('input[placeholder*="T√™n ƒê·∫°i h·ªçc"], input[placeholder*="University"], input[placeholder*="College"]');
    if (schoolInput) {
        const schoolValue = schoolInput.value;
        console.log(\`üìù Gi√° tr·ªã hi·ªán t·∫°i trong tr∆∞·ªùng ƒë·∫°i h·ªçc: "\${schoolValue}"\`);
        
        // Ki·ªÉm tra xem c√≥ ch·ª©a t√™n sinh vi√™n kh√¥ng
        if (schoolValue.includes('${studentName}') || 
            schoolValue.includes('${firstName}') || 
            schoolValue.includes('${lastName}') ||
            schoolValue.includes('${studentName.toLowerCase()}') ||
            schoolValue.includes('${firstName.toLowerCase()}') ||
            schoolValue.includes('${lastName.toLowerCase()}')) {
            
            console.log("‚ö†Ô∏è Ph√°t hi·ªán t√™n sinh vi√™n b·ªã ƒëi·ªÅn nh·∫ßm v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc!");
            console.log("üîÑ X√≥a v√† ƒë·ªÉ tr·ªëng tr∆∞·ªùng ƒë·∫°i h·ªçc...");
            
            // X√≥a n·ªôi dung
            schoolInput.value = '';
            schoolInput.dispatchEvent(new Event('input', { bubbles: true }));
            schoolInput.dispatchEvent(new Event('change', { bubbles: true }));
            schoolInput.dispatchEvent(new Event('blur', { bubbles: true }));
            
            await delay(500);
            console.log("‚úÖ ƒê√£ x√≥a t√™n sinh vi√™n kh·ªèi tr∆∞·ªùng ƒë·∫°i h·ªçc");
        } else {
            console.log("‚úÖ Tr∆∞·ªùng ƒë·∫°i h·ªçc kh√¥ng b·ªã ƒëi·ªÅn nh·∫ßm t√™n sinh vi√™n");
        }
    }
    
    // B·ªè qua ki·ªÉm tra tr∆∞·ªùng ƒë·∫°i h·ªçc
    console.log("‚è≠Ô∏è B·ªè qua ki·ªÉm tra tr∆∞·ªùng ƒë·∫°i h·ªçc theo y√™u c·∫ßu");
    
    // Ki·ªÉm tra v√† x·ª≠ l√Ω l·ªói
    await delay(1000);
    console.log("üîç Ki·ªÉm tra l·ªói form...");
    
    // Ki·ªÉm tra l·ªói network
    console.log("üåê Ki·ªÉm tra l·ªói network...");
    const networkErrors = [
        'ERR_BLOCKED_BY_CLIENT',
        'ERR_NETWORK_CHANGED',
        'ERR_INTERNET_DISCONNECTED',
        'ERR_CONNECTION_REFUSED',
        'ERR_NAME_NOT_RESOLVED'
    ];
    
    // Ki·ªÉm tra console errors
    const originalError = console.error;
    let hasNetworkErrors = false;
    console.error = function(...args) {
        const errorMessage = args.join(' ');
        if (networkErrors.some(error => errorMessage.includes(error))) {
            hasNetworkErrors = true;
            console.log(\`‚ö†Ô∏è Ph√°t hi·ªán l·ªói network: \${errorMessage}\`);
        }
        originalError.apply(console, args);
    };
    
    // T√¨m c√°c th√¥ng b√°o l·ªói form
    const errorSelectors = [
        '.error',
        '.invalid',
        '.required',
        '[class*="error"]',
        '[class*="invalid"]',
        '[class*="required"]',
        '.field-error',
        '.validation-error',
        '.alert-danger',
        '.text-danger'
    ];
    
    let hasFormErrors = false;
    for (const selector of errorSelectors) {
        const errors = document.querySelectorAll(selector);
        if (errors.length > 0) {
            console.log(\`‚ö†Ô∏è T√¨m th·∫•y \${errors.length} l·ªói form v·ªõi selector: \${selector}\`);
            errors.forEach((error, index) => {
                console.log(\`  L·ªói \${index + 1}: \${error.innerText || error.textContent}\`);
            });
            hasFormErrors = true;
        }
    }
    
    // X·ª≠ l√Ω l·ªói network
    if (hasNetworkErrors) {
        console.log("üåê Ph√°t hi·ªán l·ªói network, c√≥ th·ªÉ do:");
        console.log("   - Ad blocker ch·∫∑n request");
        console.log("   - Extension b·∫£o m·∫≠t ch·∫∑n");
        console.log("   - C√†i ƒë·∫∑t quy·ªÅn ri√™ng t∆∞");
        console.log("   - LaunchDarkly/SheerID b·ªã ch·∫∑n");
        console.log("‚ö†Ô∏è L∆∞u √Ω: L·ªói n√†y kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn vi·ªác ƒëi·ªÅn form");
    }
    
    // X·ª≠ l√Ω l·ªói form
    if (hasFormErrors) {
        console.log("‚ùå Form c√≥ l·ªói, th·ª≠ ƒëi·ªÅn l·∫°i...");
        
        // Th·ª≠ ƒëi·ªÅn l·∫°i c√°c tr∆∞·ªùng b·ªã l·ªói
        await delay(500);
        await fillPersonalInfo();
        
        // Ki·ªÉm tra l·∫°i
        await delay(1000);
        console.log("üîç Ki·ªÉm tra l·∫°i sau khi ƒëi·ªÅn l·∫°i...");
    }
    
    // Kh√¥i ph·ª•c console.error
    console.error = originalError;
    
    console.log("‚úÖ Form Google One ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅn ƒë·∫ßy ƒë·ªß v·ªõi th√¥ng tin c·ªßa ${studentName} (ch∆∞a submit)");
    
    // Hi·ªÉn th·ªã th√¥ng b√°o v·ªÅ form ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅn
    console.log("üéì Form x√°c minh sinh vi√™n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅn th√†nh c√¥ng!");
    console.log("üìã Th√¥ng tin ƒë√£ ƒëi·ªÅn:");
    console.log("   üë§ T√™n: ${studentName}");
    console.log("   üìß Email: ${email} (b·ªè d·∫•u, kh√¥ng d·∫•u ch·∫•m)");
    console.log("   üìÖ Ng√†y sinh: 18/08/1997");
    console.log("   üåç Qu·ªëc gia: Vi·ªát Nam");
    console.log("   ‚è≠Ô∏è Tr∆∞·ªùng ƒë·∫°i h·ªçc: B·ªè qua (ƒë·ªÉ tr·ªëng)");
    console.log("   ‚úÖ ƒê√£ ki·ªÉm tra kh√¥ng b·ªã ƒëi·ªÅn nh·∫ßm t√™n sinh vi√™n v√†o tr∆∞·ªùng ƒë·∫°i h·ªçc");
    console.log("   ‚ö†Ô∏è L∆∞u √Ω: B·∫°n c·∫ßn ƒëi·ªÅn tr∆∞·ªùng ƒë·∫°i h·ªçc v√† submit form th·ªß c√¥ng!");
    console.log("");
    console.log("üîß H∆∞·ªõng d·∫´n x·ª≠ l√Ω l·ªói:");
    console.log("   - N·∫øu th·∫•y l·ªói ERR_BLOCKED_BY_CLIENT: B√¨nh th∆∞·ªùng, kh√¥ng ·∫£nh h∆∞·ªüng");
    console.log("   - N·∫øu form kh√¥ng ƒëi·ªÅn ƒë∆∞·ª£c: Ki·ªÉm tra l·∫°i c√°c tr∆∞·ªùng");
    console.log("   - N·∫øu c√≥ l·ªói validation: ƒêi·ªÅn l·∫°i th√¥ng tin th·ªß c√¥ng");
    console.log("   - N·∫øu v·∫´n l·ªói: T·∫Øt ad blocker v√† th·ª≠ l·∫°i");
    console.log("   - N·∫øu t√™n sinh vi√™n b·ªã ƒëi·ªÅn nh·∫ßm: Script ƒë√£ t·ª± ƒë·ªông x√≥a v√† s·ª≠a");
})();`;

            // Hi·ªÉn th·ªã script trong modal
            showScriptModal(studentName, script);
        }

        // Hi·ªÉn th·ªã script trong modal
        function showScriptModal(studentName, script) {
            const modalHtml = `
                <div class="modal fade" id="scriptModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-code me-2"></i>Script Form cho ${studentName}
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label">Script t·ª± ƒë·ªông ƒëi·ªÅn form:</label>
                                    <textarea class="form-control" rows="15" readonly>${script}</textarea>
                                </div>
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</strong><br>
                                    1. Copy to√†n b·ªô script tr√™n<br>
                                    2. M·ªü Developer Tools (F12)<br>
                                    3. Paste v√†o Console v√† nh·∫•n Enter<br>
                                    4. Script s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅn form
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" onclick="copyScript()">
                                    <i class="fas fa-copy me-1"></i>Copy Script
                                </button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // X√≥a modal c≈© n·∫øu c√≥
            const existingModal = document.getElementById('scriptModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Th√™m modal m·ªõi
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            // Hi·ªÉn th·ªã modal
            const modal = new bootstrap.Modal(document.getElementById('scriptModal'));
            modal.show();
        }

        // Copy script
        function copyScript() {
            const textarea = document.querySelector('#scriptModal textarea');
            textarea.select();
            document.execCommand('copy');
            showAlert('Script ƒë√£ ƒë∆∞·ª£c copy v√†o clipboard!', 'success');
        }

        // Hi·ªÉn th·ªã th√¥ng b√°o
        function showAlert(message, type) {
            const container = document.getElementById('alertContainer');
            const alertId = 'alert-' + Date.now();
            
            container.innerHTML = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert" id="${alertId}">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : type === 'danger' ? 'times-circle' : 'info-circle'} me-2"></i>
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                const alert = document.getElementById(alertId);
                if (alert) {
                    alert.remove();
                }
            }, 5000);
        }

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>